<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="700" height="550" viewBox="0 0 700 550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #fff; stroke: #666; stroke-width: 2; rx: 8; }
      .code { fill: #f5f5f5; stroke: #999; }
      .acsl { fill: #e3f2fd; stroke: #1976d2; }
      .vc { fill: #fff9c4; stroke: #f57f17; }
      .solver { fill: #c8e6c9; stroke: #2e7d32; }
      .result { fill: #ffccbc; stroke: #d84315; }
      .arrow { fill: none; stroke: #666; stroke-width: 2; marker-end: url(#arrowhead); }
      .label { font-family: Arial, sans-serif; font-size: 13px; fill: #333; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #1976d2; text-anchor: middle; }
      .code-text { font-family: "Courier New", monospace; font-size: 10px; fill: #333; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666"/>
    </marker>
  </defs>
  
  <text x="350" y="25" class="title">Flujo de Verificación Automática con Frama-C</text>
  
  <!-- Step 1: Annotated code -->
  <g id="step1">
    <rect x="50" y="60" width="250" height="110" class="box code"/>
    <text x="175" y="85" class="label" font-weight="bold" font-size="14">1. Código Anotado (C + ACSL)</text>
    
    <text x="70" y="105" class="code-text" text-anchor="start">/*@ requires n > 0;</text>
    <text x="70" y="120" class="code-text" text-anchor="start">    ensures \result >= 0;</text>
    <text x="70" y="135" class="code-text" text-anchor="start">  */</text>
    <text x="70" y="150" class="code-text" text-anchor="start">int funcion(int n) {</text>
    <text x="70" y="165" class="code-text" text-anchor="start">  return n * 2;</text>
  </g>
  
  <path d="M 175,175 L 175,210" class="arrow"/>
  
  <!-- Step 2: WP Plugin -->
  <g id="step2">
    <rect x="75" y="220" width="200" height="70" class="box acsl"/>
    <text x="175" y="242" class="label" font-weight="bold" font-size="14" fill="#1976d2">2. WP Plugin</text>
    <text x="175" y="260" class="label" font-size="11">(Weakest Precondition)</text>
    
    <text x="175" y="280" class="label" font-size="10">Genera Verification</text>
    <text x="175" y="292" class="label" font-size="10">Conditions (VCs)</text>
  </g>
  
  <path d="M 175,295 L 175,330" class="arrow"/>
  
  <!-- Step 3: VCs -->
  <g id="step3">
    <rect x="50" y="340" width="250" height="90" class="box vc"/>
    <text x="175" y="362" class="label" font-weight="bold" font-size="14" fill="#f57f17">3. Condiciones de Verificación</text>
    
    <text x="70" y="385" class="code-text" text-anchor="start">VC1: n > 0 → n * 2 >= 0</text>
    <text x="70" y="400" class="code-text" text-anchor="start">VC2: ∀x. x > 0 → x * 2 >= 0</text>
    <text x="70" y="415" class="code-text" text-anchor="start">...</text>
  </g>
  
  <path d="M 300,385 L 345,385" class="arrow"/>
  
  <!-- Step 4: SMT Solvers -->
  <g id="step4">
    <rect x="350" y="340" width="300" height="90" class="box solver"/>
    <text x="500" y="362" class="label" font-weight="bold" font-size="14" fill="#2e7d32">4. SMT Solvers</text>
    
    <rect x="370" y="375" width="70" height="30" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1" rx="3"/>
    <text x="405" y="395" class="label" font-size="11">Z3</text>
    
    <rect x="455" y="375" width="70" height="30" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1" rx="3"/>
    <text x="490" y="395" class="label" font-size="11">CVC4</text>
    
    <rect x="540" y="375" width="80" height="30" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1" rx="3"/>
    <text x="580" y="395" class="label" font-size="11">Alt-Ergo</text>
    
    <text x="500" y="420" class="label" font-size="10">Intentan probar VCs</text>
  </g>
  
  <path d="M 500,435 L 500,470" class="arrow"/>
  
  <!-- Step 5: Results -->
  <g id="step5">
    <rect x="350" y="480" width="300" height="55" class="box result"/>
    <text x="500" y="502" class="label" font-weight="bold" font-size="14" fill="#d84315">5. Resultado</text>
    
    <circle cx="385" cy="522" r="8" fill="#4caf50"/>
    <text x="405" y="527" class="label" font-size="11" text-anchor="start">Probado: VC es válida</text>
    
    <circle cx="530" cy="522" r="8" fill="#f44336"/>
    <text x="550" y="527" class="label" font-size="11" text-anchor="start">Fallo: contraejemplo</text>
  </g>
  
  <!-- Alternative path for manual proof -->
  <path d="M 175,435 L 175,480" class="arrow" stroke-dasharray="5,5"/>
  <text x="190" y="460" class="label" font-size="10" fill="#999">Si falla</text>
  
  <g id="manual">
    <rect x="50" y="480" width="250" height="55" fill="#e1bee7" stroke="#6a1b9a" stroke-width="1.5" rx="5"/>
    <text x="175" y="502" class="label" font-weight="bold" font-size="12" fill="#6a1b9a">Prueba Manual (Coq/Isabelle)</text>
    <text x="175" y="520" class="label" font-size="10">Asistente interactivo de pruebas</text>
  </g>
  
  <!-- Legend -->
  <rect x="50" y="545" width="600" height="1" fill="none" stroke="#ddd"/>
</svg>
